(()=>{"use strict";var t;!function(t){t.EQUAL_TO="==",t.NOT_EQUAL_TO="!=",t.LESS_THAN="<",t.GREATER_THAN=">",t.LESS_THAN_EQUAL_TO="<=",t.GREATER_THAN_EQUAL_TO=">=",t.ASSIGN="=",t.PLUS_ASSIGN="+=",t.MINUS_ASSIGN="-=",t.MULTIPLY_ASSIGN="*=",t.DIVIDE_ASSIGN="/=",t.MOD_ASSIGN="%=",t.POW_ASSIGN="**=",t.PLUS="+",t.MINUS="-",t.MULTIPLY="*",t.DIVIDE="/",t.MODULO="%",t.POWER="**",t.AND="and",t.OR="or",t.NOT="not",t.BIT_AND="&",t.BIT_OR="|",t.BIT_NOT="~",t.BIT_XOR="^",t.BIT_SHIFT_LEFT="<<",t.BIT_SHIFT_RIGHT=">>",t.INCREMENT="++",t.DECREMENT="--",t.NEGATE="!",t.NUMBER="number",t.STRING="string",t.BOOLEAN="boolean",t.NULL="null",t.LET="let",t.IF="if",t.ELSE="else",t.SWITCH="switch",t.CASE="case",t.DEFAULT="default",t.FOR="for",t.WHILE="while",t.DO="do",t.BREAK="break",t.CONTINUE="continue",t.IN="in",t.INSTANCEOF="instanceof",t.FUNCTION="fn",t.RETURN="return",t.TRUE="true",t.FALSE="false",t.LPAREN="(",t.RPAREN=")",t.LBRACKET="[",t.RBRACKET="]",t.LBRACE="{",t.RBRACE="}",t.COMMA=",",t.COLON=":",t.SEMICOLON=";",t.COMMENT="//",t.IDENTIFIER="identifier",t.EOF="\0"}(t||(t={}));const e=Object.freeze(new Map([["let",t.LET],["switch",t.SWITCH],["if",t.IF],["else",t.ELSE],["case",t.CASE],["default",t.DEFAULT],["for",t.FOR],["while",t.WHILE],["do",t.DO],["break",t.BREAK],["continue",t.CONTINUE],["in",t.IN],["instanceof",t.INSTANCEOF],["fn",t.FUNCTION],["return",t.RETURN],["true",t.TRUE],["false",t.FALSE],["in",t.IN],["and",t.AND],["or",t.OR],["not",t.NOT],["null",t.NULL]]));class s{constructor(t){this.text=t,this.tokens_list=Array(),this.curr_line=0,this.curr_col=0,this.start_read_index=0,this.next_read_index=0,this.end_of_literal_regex=/[\s\n(){},:;+/*%&|^<=>!\-\[\]]/,this.whitespace_regex=/\s/,this.is_analysis_complete=!1,this._errors=Array()}get errors(){return this._errors}getTokens(){for(;!this.isEOF();)this.start_read_index=this.next_read_index,this.scanToken();return this.is_analysis_complete||(this.is_analysis_complete=!0,this.addToken(t.EOF)),this.tokens_list}getLastToken(){return this.tokens_list[this.tokens_list.length-1]}scanToken(){const e=this.consume();if(!e.match(this.whitespace_regex))if(e.match(/[a-zA-Z_]/))this.consume_identifier(e);else if(e.match(/[0-9]/))this.consume_number(e);else switch(e){case"(":case")":case"[":case"]":case"{":case"}":case".":case",":case":":case";":case"&":case"|":case"^":case"~":this.addToken(e);break;case"=":"="==this.peek()?(this.consume(),this.addToken(t.EQUAL_TO)):this.addToken(t.ASSIGN);break;case"<":"="==this.peek()?(this.consume(),this.addToken(t.LESS_THAN_EQUAL_TO)):"<"==this.peek()?(this.consume(),this.addToken(t.BIT_SHIFT_LEFT)):this.addToken(t.LESS_THAN);break;case">":"="==this.peek()?(this.consume(),this.addToken(t.GREATER_THAN_EQUAL_TO)):">"==this.peek()?(this.consume(),this.addToken(t.BIT_SHIFT_RIGHT)):this.addToken(t.GREATER_THAN);break;case"!":"="==this.peek()?(this.consume(),this.addToken(t.NOT_EQUAL_TO)):this.addToken(t.NEGATE);break;case"+":"="==this.peek()?(this.consume(),this.addToken(t.PLUS_ASSIGN)):"+"==this.peek()?(this.consume(),this.addToken(t.INCREMENT)):this.addToken(t.PLUS);break;case"-":"="==this.peek()?(this.consume(),this.addToken(t.MINUS_ASSIGN)):"-"==this.peek()?(this.consume(),this.addToken(t.DECREMENT)):this.addToken(t.MINUS);break;case"*":"="==this.peek()?(this.consume(),this.addToken(t.MULTIPLY_ASSIGN)):"*"==this.peek()?(this.consume(),"="==this.peek()?(this.consume(),this.addToken(t.POW_ASSIGN)):this.addToken(t.POWER)):this.addToken(t.MULTIPLY);break;case"%":"="==this.peek()?(this.consume(),this.addToken(t.MOD_ASSIGN)):this.addToken(t.MODULO);break;case"/":switch(this.peek()){case"/":for(this.consume();!this.isEOF()&&"\n"!==this.peek();)this.consume();break;case"=":this.consume(),this.addToken(t.DIVIDE_ASSIGN);break;default:this.addToken(t.DIVIDE)}break;case'"':case"'":this.consume_string(e);break;default:this.error(`Invalid token "${e}"`)}}isEOF(){return this.text.length-1<this.next_read_index}error(t){this._errors.push({column:this.curr_col,highlight:this.getCurrentColumnHighlighted(),line:this.curr_line,message:t})}getCurrentColumnHighlighted(){let t=this.next_read_index-1,e=this.text.lastIndexOf("\n",t)+1,s=this.text.indexOf("\n",t);-1===s&&(s=this.text.length);const i=this.text.slice(e,s),n=this.next_read_index-1-e,o=i.trim(),a=i.length-i.trimStart().length;return o+"\n"+" ".repeat(n-a)+"^"}peek(){return this.isEOF()?"\0":this.text[this.next_read_index]}consume(){if(this.isEOF())return"\0";const t=this.text[this.next_read_index];return"\n"===t&&(this.curr_line++,this.curr_col=0),this.next_read_index++,this.curr_col++,t}addToken(t,e=null){const s=this.text.slice(this.start_read_index,this.next_read_index);this.tokens_list.push({token_type:t,lexeme:s,literal:e,col:this.curr_col,line:this.curr_line})}consume_identifier(s){const i=/[a-zA-Z0-9_]/;let n=s;for(;!this.isEOF();){const t=this.peek();if(t.match(this.end_of_literal_regex))break;if(!t.match(i)){this.error(`"${t}" is an invalid character used for identifier`),this.consume();break}n+=t,this.consume()}e.has(n)?"true"===n?this.addToken(t.TRUE,!0):"false"===n?this.addToken(t.FALSE,!1):this.addToken(n,n):this.addToken(t.IDENTIFIER,n)}consume_number(e){const s=/[0-9_]/;let i=!1,n=e,o=e;for(;!this.isEOF()&&(o=this.peek(),!o.match(this.end_of_literal_regex));)o.match(s)?"_"!==o&&(n+=o):"."!=o||i?o.match(/[a-zA-Z]/)?this.error("Identifiers cannot begin with a number"):this.error(`Invalid character used for a number: "${o}"`):(i=!0,n+=o),this.consume();this.addToken(t.NUMBER,n)}consume_string(t){let e="";for(;!this.isEOF();){const s=this.consume();if(s===t)break;if("\n"==s)return void this.error(`Invalid newline in single line string after ${e}`);if("\0"==s)return void this.error(`Reached end of file after ${e}`);if("\\"===s)switch(this.consume()){case"n":e+="\n";break;case"t":e+="\t";break;case"\r":e+="\r";break;case"\\":e+="\\";break;case"'":e+="'"}else e+=s}}}class i{static roundedClamp(t,e,s){return i.clamp(Math.round(t),e,s)}static clamp(t,e,s){return Math.max(Math.min(t,s),e)}static round(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}}class n{constructor(...t){if("string"==typeof t[0]){this.hex=t[0];const{r:e,g:s,b:i,a:o}=n.hexToRgba(this.hex);this.r=e,this.g=s,this.b=i,this.a=o}else{const[e=0,s=0,o=0,a=1]=t;this.r=e,this.g=i.clamp(s,0,255),this.b=i.clamp(o,0,255),this.a=i.clamp(a,0,255),this.hex=n.getHex(e,s,o,a)}}static hexToRgba(t){if(t=t.replace(/^#/,""),![3,4,6,8].includes(t.length))throw new Error("Invalid hex color code"+t+". Must be 3, 4, 6, or 8 digits. but was"+t);3!==t.length&&4!==t.length||(t=t.split("").map(t=>t+t).join(""));let e,s,i,n=1;return 6===t.length?(e=parseInt(t.slice(0,2),16),s=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16)):(e=parseInt(t.slice(0,2),16),s=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16),n=parseInt(t.slice(6,8),16)/255),n=Math.round(100*n)/100,{r:e,g:s,b:i,a:n}}static getHex(t,e,s,i){return`#${t.toString(16).padStart(2,"0")}${e.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${i?Math.round(255*i).toString(16).padStart(2,"0"):""}`}toString(){return 1===this.a?`rgb(${this.r}, ${this.g}, ${this.b})`:`rgba(${this.r}, ${this.g}, ${this.b}, ${this.a.toFixed(2)})`}}function o(t,e,s,i){return t===e?e:t+(e-t)*i(s)}class a{static linear(t){return t}static easeInSin(t){return 1-Math.cos(t*Math.PI/2)}static easeOutSin(t){return Math.sin(t*Math.PI/2)}static easeInOutSin(t){return(1-Math.cos(t*Math.PI))/2}static easeInCubic(t){return Math.pow(t,3)}static easeOutCubic(t){return 1-Math.pow(1-t,3)}static easeInOutCubic(t){return t<.5?4*Math.pow(t,3):1-Math.pow(1-t,3)}static easeInQuad(t){return t*t}static easeOutQuad(t){return 1-Math.pow(1-t,2)}static easeInOutQuad(t){return t<.5?2*Math.pow(t,2):1-Math.pow(1-t,2)}}class h{constructor(t,e,s){this.total_duration_ms=e,this.duration_passed_ms=0,this.easing=s,this.drawable=t}getId(){return this.drawable?this.constructor.name+this.drawable.id:this.constructor.name}}class r extends h{constructor(t,e,s,i=250,n=a.easeInSin){super(t,i,n),this.from=e,this.to=s,this.drawable.is_color_animating=!0}finalize(){this.setNormalizedTime(1),this.drawable.is_color_animating=!1,this.drawable.color=this.to,this.interrupt()}interrupt(){this.drawable.is_color_animating=!1}setNormalizedTime(t){const e=i.roundedClamp(o(this.from.r,this.to.r,t,this.easing),0,255),s=i.roundedClamp(o(this.from.g,this.to.g,t,this.easing),0,255),a=i.roundedClamp(o(this.from.b,this.to.b,t,this.easing),0,255),h=i.roundedClamp(o(this.from.a,this.to.a,t,this.easing),0,255);this.drawable.color=new n(e,s,a,h)}}class c extends h{constructor(t,e,s,i=250,n=a.easeInSin){super(null,i,n),this.callback=t,this.from=e,this.to=s}finalize(){this.setNormalizedTime(1)}interrupt(){}setNormalizedTime(t){this.callback(o(this.from,this.to,t,this.easing),1===t)}}class d{constructor(){this.animations_map=new Map}add(t){var e;const s=t.getId();this.animations_map.has(s)&&(null===(e=this.animations_map.get(s))||void 0===e||e.interrupt()),this.animations_map.set(s,t)}step(t){for(const[e,s]of this.animations_map){if(s.duration_passed_ms+=t,s.duration_passed_ms>s.total_duration_ms){s.duration_passed_ms=s.total_duration_ms,s.finalize(),this.animations_map.delete(e);break}const i=s.duration_passed_ms/s.total_duration_ms;s.setNormalizedTime(i)}}}var l,u;!function(t){t[t.LIGHT=0]="LIGHT",t[t.DARK=1]="DARK",t[t.AUTO=2]="AUTO"}(l||(l={})),function(t){t.DEFAULT="default",t.HIGHLIGHTED="highlighted",t.SELECTED="selected",t.HOVER="hover",t.ON_BACKGROUND="on-background",t.ON_PRIMARY="on-primary",t.ON_SECONDARY="on-secondary",t.BORDER="border"}(u||(u={}));const m=function(){const t="theme";let e=!1,s=!1,i=getComputedStyle(document.documentElement);function o(){i=getComputedStyle(document.documentElement)}return{setThemeType:n=>{switch(i=getComputedStyle(document.documentElement),e=!1,n){case l.LIGHT:document.documentElement.setAttribute(t,"light");break;case l.DARK:document.documentElement.setAttribute(t,"dark");break;case l.AUTO:!function(){if(window.matchMedia){const i=window.matchMedia("(prefers-color-scheme: dark)");if(e=!0,i.matches?document.documentElement.setAttribute(t,"dark"):document.documentElement.setAttribute(t,"light"),s)return;i.addEventListener("change",i=>{s=!0,e&&(o(),i.matches?document.documentElement.setAttribute(t,"dark"):document.documentElement.setAttribute(t,"light"))})}else document.documentElement.setAttribute(t,"light")}()}o()},getBgColor(t,e=u.DEFAULT){const s=`--${t}-bg-${e}-color`,o=i.getPropertyValue(s);return""===o&&console.error(s," is not defined."),new n(o)},getFgColor(t,e=u.DEFAULT){const s=`--${t}-fg-${e}-color`,o=i.getPropertyValue(s);return""===o&&console.error(s," is not defined."),new n(o)},getTextColor(t=u.ON_BACKGROUND){const e=`--text-${t}-color`,s=i.getPropertyValue(e);return""===s&&console.error(e," is not defined."),new n(s)},getColor(t){const e=`--${t}-color`,s=i.getPropertyValue(e);return""===s&&console.error(e,"is not defined."),new n(s)}}}();class _{constructor(t=0,e=0){this.x=t,this.y=e}copy(){return new _(this.x,this.y)}length_sqrd(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.length_sqrd())}set(t,e){return this.x=t,this.y=e,this}add(t){return new _(this.x+t.x,this.y+t.y)}addXY(t,e){return new _(this.x+t,this.y+e)}add_self(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return new _(this.x-t.x,this.y-t.y)}subXY(t,e){return new _(this.x-t,this.y-e)}sub_self(t){return this.x-=t.x,this.y-=t.y,this}scale(t,e){return e||(e=t),new _(this.x*t,this.y*e)}scale_self(t,e){return e||(e=t),this.x*=t,this.y*=t,this}dot(t){return this.x*t.x+this.y*t.y}toString(){return this.x+"i + "+this.y+"j"}}_.unit_x=Object.freeze(new _(1,0)),_.unit_y=Object.freeze(new _(0,1)),_.ZERO=Object.freeze(new _(0,0));class g{constructor(t,e){this.width=t,this.height=e}scale(t){return new g(this.width*t,this.height*t)}scale_self(t){return this.width*=t,this.height*=t,this}max(){return Math.max(this.width,this.height)}toString(){return this.width+"x"+this.height}set(t,e){this.width=t,this.height=e}copy(){return new g(this.width,this.height)}}g.ZERO=Object.freeze(new g(0,0));class f{constructor(t,e,s){this.scene=t,this.class_name=s,this.pos=new _(0,0),this.is_color_animating=!1,this.color=new n("#f00"),this.ctx=t.ctx,this.id=e,this.color_state=u.DEFAULT}highlight(){this.scene.animator.add(new r(this,this.color,m.getBgColor(this.getName(),u.HIGHLIGHTED))),this.color_state=u.HIGHLIGHTED}getName(){return this.class_name.toLowerCase()}update(t){this.is_color_animating||(this.color=m.getBgColor(this.getName(),this.color_state))}drawPointVec(t,e="green"){const s=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));s>1&&this.drawArrow(100*t.x/s,100*t.y/s,e)}drawArrow(t,e,s="green"){if(0===t&&0===e)return;this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.lineCap="round",this.ctx.strokeStyle=s,this.ctx.moveTo(this.pos.x,this.pos.y);const i=this.pos.add(new _(t,e));this.ctx.lineTo(i.x,i.y),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()}drawCircle(t,e,s,i,n=!1,o,a=1){if(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(e,s,t,0,2*Math.PI),this.ctx.fillStyle=i,n){let t=this.ctx.strokeStyle;this.ctx.lineWidth=a,this.ctx.strokeStyle=o,this.ctx.strokeStyle=t,this.ctx.stroke()}this.ctx.fill(),this.ctx.closePath(),this.ctx.restore()}reset(){console.error("Reset not implemented for",this.constructor.name)}drawLine(t,e,s,i,n,o){this.ctx.save(),this.ctx.strokeStyle=o,this.ctx.lineWidth=n,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(s,i),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()}drawText(t,e,s,i,n=1){this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.font=`${n}em Arial`,this.ctx.fillStyle=i,this.ctx.fillText(t,e,s),this.ctx.restore()}drawRect(t,e,s,i,n="#000",o,a=0,h){this.ctx.save(),this.ctx.fillStyle=n,a>0&&(this.ctx.strokeStyle=o),this.ctx.beginPath(),this.ctx.roundRect(300,5,200,100,h),this.ctx.closePath(),this.ctx.restore()}}class p extends f{constructor(t,e,s){super(t,p.getEdgeKey(e.id,s.id),"edge"),this.start_node=e,this.end_node=s}static getEdgeKey(t,e){return[t,e].sort().join()}render(){this.drawLine(this.start_node.pos.x,this.start_node.pos.y,this.end_node.pos.x,this.end_node.pos.y,p.thickness,this.color.hex)}}function w(t,e){const s=document.createElement("div");switch(e){case"info":s.style.backgroundColor="rgba(0,140,255,0.18)";break;case"warn":s.style.backgroundColor="rgba(255,241,0,0.18)";break;case"error":s.style.backgroundColor="rgba(255,0,0,0.18)";break;case"success":s.style.backgroundColor="rgba(55,255,0,0.18)";break;default:s.style.backgroundColor="rgba(0,0,0,0.18)"}return Object.assign(s.style,{minWidth:"100%",borderRadius:"8px",fontFamily:"sans-serif",width:"fit-content",justifyContent:"space-between",padding:"0.5em"}),s.innerText=`[${e}]\t\t\t${t}`,s}p.thickness=3;class x{constructor(t,e){const s=document.createElement("div"),i=document.createElement("div");i.innerText=t,this.value_el=document.createElement("div"),s.append(i,this.value_el),Object.assign(s.style,{minWidth:"100%",display:"flex",borderRadius:"8px",backgroundColor:"rgba(255,255,255,0.04)",fontFamily:"sans-serif",width:"fit-content",justifyContent:"space-between",padding:"0.1em"}),Object.assign(i.style,{fontWeight:"bold",color:"#ececec",padding:"0.5em",minWidth:"max-content"}),Object.assign(this.value_el.style,{color:"#ffffff",padding:"0.5em",alignContent:"right"}),e.append(s)}set(t){this.value_el.innerText=t}}class C{constructor(t,e){this.center=t,this.half_dimension=e}static fromRect(t,e,s,i){return new C(new _(t+s/2,e+i/2),new g(s/2,i/2))}update(t,e){this.center=t,this.half_dimension=e}updateRect(t,e,s,i){this.center.set(t+s/2,e+i/2),this.half_dimension.set(s/2,i/2)}containsPoint(t){return Math.abs(t.x-this.center.x)<=this.half_dimension.width&&Math.abs(t.y-this.center.y)<=this.half_dimension.height}intersectsAABB(t){return this.center.x-t.center.x<=this.half_dimension.width+t.half_dimension.width&&this.center.y-t.center.y<=this.half_dimension.height+t.half_dimension.height}toString(){return`${this.center} ${this.half_dimension}`}copy(){return new C(this.center.copy(),this.half_dimension.copy())}}class v{constructor(t,e,s=10){this.id=t,this.point=e,this.mass=s}}setInterval(()=>{var t;N.ACCURACY=null===(t=document.getElementById("accuracy-slider"))||void 0===t?void 0:t.valueAsNumber},100);class N{constructor(t){this.mass=0,this.regions=[],this.has_sub_divisions=!1,this.region_name="",this.boundary=t,this.has_sub_divisions=!1}subdivide(){const t=this.boundary.half_dimension,e=this.boundary.center,s=new N(new C(new _(e.x+t.width/2,e.y-t.height/2),this.boundary.half_dimension.scale(.5))),i=new N(new C(new _(e.x-t.width/2,e.y-t.height/2),this.boundary.half_dimension.scale(.5))),n=new N(new C(new _(e.x-t.width/2,e.y+t.height/2),this.boundary.half_dimension.scale(.5))),o=new N(new C(new _(e.x+t.width/2,e.y+t.height/2),this.boundary.half_dimension.scale(.5)));this.regions.push(s,i,n,o),this.has_sub_divisions=!0}contains(t){return this.boundary.containsPoint(t)}insert(t){var e,s;if(!this.boundary.containsPoint(t.point))return!1;if(!this.node&&!this.has_sub_divisions)return this.node=t,this.COM=t.point.copy(),this.mass=t.mass,!0;this.has_sub_divisions||this.subdivide(),this.region_name="";let i=!1;for(const t of this.regions)!i&&this.node&&t.insert(this.node)&&(i=!0,this.node=void 0),this.region_name+=null!==(s=null===(e=t.node)||void 0===e?void 0:e.id)&&void 0!==s?s:"";let n=!1;for(const e of this.regions)if(e.insert(t)){n=!0;break}if(n){const e=this.mass+t.mass;if(!this.COM)return!0;this.COM.scale_self(this.mass).add_self(t.point.scale(t.mass)).scale_self(1/e),this.mass=e}return n}getTotalForcesOnPoint(t,e){if(0===this.regions.length)return new _(0,0);const s=new _(0,0),i=this.getNodesInCircularRange(t.point,N.FULL_ACCURACY_CIRCLE_RADIUS);for(const n of i)t.id!=n.id&&s.add_self(e(t,n));return s.add_self(this.getForceDueToRegions(t,e,i)),s}getForceDueToRegions(t,e,s=[],i=0){const n=new _(0,0),o=1-N.ACCURACY;for(const a of this.regions){if(!a.COM||0===a.mass)continue;const h=a.COM.x-t.point.x,r=a.COM.y-t.point.y;let c=h*h+r*r;if(a.boundary.half_dimension.width/Math.sqrt(c)>=o&&a.has_sub_divisions)n.add_self(a.getForceDueToRegions(t,e,s,i+1));else{if(Math.abs(h)<1e-6&&Math.abs(r)<1e-6)continue;const s=new v(a.region_name,a.COM,a.mass);n.add_self(e(t,s))}}return n}getNodesInRange(t){const e=[];if(!this.boundary.intersectsAABB(t))return e;if(!this.has_sub_divisions)return this.node&&t.containsPoint(this.node.point)&&e.push(this.node),e;for(const s of this.regions)e.push(...s.getNodesInRange(t));return e}getNodesInCircularRange(t,e){const s=[];if(!function(t,e,s){const i=s.center.x-s.half_dimension.width,n=s.center.x+s.half_dimension.width,o=s.center.y-s.half_dimension.height,a=s.center.y+s.half_dimension.height,h=Math.max(i,Math.min(t.x,n)),r=Math.max(o,Math.min(t.y,a)),c=t.x-h,d=t.y-r;return c*c+d*d<=e*e}(t,e,this.boundary))return s;if(!this.has_sub_divisions)return this.node&&function(t,e,s){const i=t.x-s.x,n=t.y-s.y;return i*i+n*n<=e*e}(t,e,this.node.point)&&s.push(this.node),s;for(const i of this.regions)s.push(...i.getNodesInCircularRange(t,e));return s}*getAllRegions(){if(yield this,this.has_sub_divisions)for(const t of this.regions)yield*t.getAllRegions()}toString(){}}N.ACCURACY=.9,N.FULL_ACCURACY_AREA=new g(100,100),N.FULL_ACCURACY_CIRCLE_RADIUS=100;class y extends f{constructor(t,e,s,i,n=""){super(t,e,"node"),this.attr_force=new _(0),this.repln_force=new _(0),this.alpha=1,this.position_change=new _(0,0),this.velocity=new _(0),this.force=new _(0),this.max_velocity=100,this.velocity_decay=.5,this.min_velocity=1,this.pos.set(s.x,s.y),this.text=n,this.radius=i,this.mass=1,this.quad_tree_node=new v(e,this.pos,100)}update(t){super.update(20);const e=.02;this.force.x=this.attr_force.x+this.repln_force.x,this.force.y=this.attr_force.y+this.repln_force.y,this.force.scale_self(this.alpha);let s=i.clamp(this.force.x*e,-this.max_velocity,this.max_velocity),n=i.clamp(this.force.y*e,-this.max_velocity,this.max_velocity);this.velocity.x+=s,this.velocity.y+=n,this.velocity.scale_self(1-this.velocity_decay),Math.abs(this.velocity.x)<this.min_velocity&&(this.velocity.x=0),Math.abs(this.velocity.y)<this.min_velocity&&(this.velocity.y=0);const o=this.velocity.x*e,a=this.velocity.y*e;this.pos.x+=o,this.pos.y+=a,this.position_change.set(o,a),this.alpha-=this.alpha*y.alphaDecay,this.alpha<1e-9&&(this.alpha=0),this.repln_force.set(0,0),this.attr_force.set(0,0)}render(){this.drawCircle(this.radius,this.pos.x,this.pos.y,this.color.hex,!0,m.getBgColor(this.getName(),u.BORDER).hex,1),this.drawText(this.id,this.pos.x,this.pos.y,m.getTextColor(u.ON_PRIMARY).hex)}getDistanceFromPoint(t){const e=this.pos.subtract(t).length_sqrd();return Math.sqrt(e)}containsPoint(t,e){const s=this.pos,i=new _(t,e).sub_self(s).length_sqrd();return Math.pow(this.radius,2)>i}}y.alphaDecay=.0016;const T=!1;var E;!function(t){t[t.Primary=0]="Primary",t[t.Auxiliary=1]="Auxiliary",t[t.Secondary=2]="Secondary"}(E||(E={}));class b{constructor(t){this.location=new _,this.buttonsPressed=new Set,this.touches=[],this.isTouching=!1,this.onMouseMove=t=>{const e=this.element.getBoundingClientRect();this.location=new _(t.clientX-e.x,t.clientY-e.y)},this.onMouseDown=t=>{t.target===this.element&&this.buttonsPressed.add(t.button)},this.onMouseUp=t=>{this.buttonsPressed.delete(t.button)},this.onTouchStart=t=>{if(t.target!==this.element)return;const e=this.element.getBoundingClientRect();this.isTouching=!0,this.touches=Array.from(t.touches).map(t=>new _(t.clientX-e.x,t.clientY-e.y)),this.location=this.touches[0]},this.onTouchMove=t=>{const e=this.element.getBoundingClientRect();this.touches=Array.from(t.touches).map(t=>new _(t.clientX-e.x,t.clientY-e.y)),this.location=this.touches[0]},this.onTouchEnd=t=>{const e=this.element.getBoundingClientRect();this.touches=Array.from(t.touches).map(t=>new _(t.clientX-e.x,t.clientY-e.y)),this.isTouching=this.touches.length>0,this.touches.length>0&&(this.location=this.touches[0])},this.element=t,window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchstart",this.onTouchStart,{passive:T}),window.addEventListener("touchmove",this.onTouchMove,{passive:T}),window.addEventListener("touchend",this.onTouchEnd),window.addEventListener("touchcancel",this.onTouchEnd)}isButtonDown(t){return this.buttonsPressed.has(t)}dispose(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),window.removeEventListener("touchcancel",this.onTouchEnd)}}const M=Object.freeze({x:0,y:0}),L=new class{constructor(t){this.reactive_logger_map=new Map,this.container_el=document.createElement("div"),this.reactive_logger_container=document.createElement("div"),this.container_el.id=t;const e=document.createElement("h2");e.style.textAlign="center",e.style.padding="0.5em",e.innerText=t,Object.assign(this.container_el.style,{display:"flex",flexDirection:"column",width:"300px",minWidth:"50",maxWidth:"100vw",padding:"0.5em",overflow:"scroll",border:"1px solid #333",borderRadius:"8px",backgroundColor:"#000000",boxShadow:"0 0 40px rgba(0, 0, 0, 0.8)",fontFamily:"sans-serif",maxHeight:"90vh",minHeight:"50px",height:"fit-content",position:"fixed",top:"1em",left:"50%",zIndex:"1000",resize:"both",scrollingBehavior:"none"}),this.container_el.addEventListener("mousedown",t=>{t.clientY-this.container_el.offsetTop>50||(this.mouse_down_event=t,this.container_el.style.transform="unset")}),this.container_el.addEventListener("touchstart",t=>{const e=t.touches[0];e.clientY-this.container_el.offsetTop>50||!e||(this.mouse_down_event=e,this.container_el.style.transform="unset")}),window.addEventListener("mousemove",t=>{this.mouse_down_event&&(this.container_el.style.left=`${this.container_el.offsetLeft+(t.clientX-this.mouse_down_event.clientX)}px`,this.container_el.style.top=`${this.container_el.offsetTop+(t.clientY-this.mouse_down_event.clientY)}px`,this.mouse_down_event=t)}),window.addEventListener("touchmove",t=>{const e=t.touches[0];this.mouse_down_event&&e&&(this.container_el.style.left=`${this.container_el.offsetLeft+(e.clientX-this.mouse_down_event.clientX)}px`,this.container_el.style.top=`${this.container_el.offsetTop+(e.clientY-this.mouse_down_event.clientY)}px`,this.mouse_down_event=e)}),this.container_el.addEventListener("mouseup",()=>this.mouse_down_event=void 0),this.container_el.addEventListener("touchend",()=>this.mouse_down_event=void 0),document.body.append(this.container_el),this.container_el.append(e,this.reactive_logger_container)}info(t){this.container_el.appendChild(w(t,"info"))}warn(t){this.container_el.appendChild(w(t,"warn"))}error(t){this.container_el.appendChild(w(t,"error"))}getReactiveLog(t){let e=this.reactive_logger_map.get(t);return e||(e=new x(t,this.reactive_logger_container),this.reactive_logger_map.set(t,e)),e}success(t){this.container_el.appendChild(w(t,"success"))}}("scene-logger");class R{constructor(t,e){this.func=t,this.wait_ms=e,this.lastCall=0,this.lastCall=-e}call(...t){const e=Date.now();e-this.lastCall>=this.wait_ms&&(this.lastCall=e,this.func(...t))}}class I{constructor(){this.camera_updated=!0,this.onupdate=null,this._x=0,this._y=0,this._zoom=1}get x(){return this._x}set x(t){this._x=t,this.camera_updated=!0,this.onupdate&&this.onupdate()}get y(){return this._y}set y(t){this._y=t,this.camera_updated=!0,this.onupdate&&this.onupdate()}get zoom(){return this._zoom}set zoom(t){this._zoom=t,this.camera_updated=!0,this.onupdate&&this.onupdate()}}class A{constructor(t,e=!1){this.ctx=t,this.show_fps=e,this.animator=new d,this.camera=new I,this.target_frame_rate=60,this.nodes=new Map,this.edges=new Map,this.accumulated_alpha=0,this.accumulated_frame_time=0,this.accumulated_node_position_change=-1,this.fps=0,this.last_animation_call_time=0,this.drawable_selected=null,this.grid_size=new g(100,100),this.prev_mouse_pos=new _,this.fps_counter=0,this.bounds=C.fromRect(0,0,0,0),this.required_size=null,this.offset=new _(0),this.dragging_camera=!1,this.is_zooming=!1,this.initial_touches=null,this.pinching_to_zoom=!1,this.repaint_drawables=!1,this.bounds_updated=!1,this.last_draw_image=null,this.is_loop_running=!1,this.ctx.scale(devicePixelRatio,devicePixelRatio),this.show_fps=e,this.is_running=!1,this.debug_box_el=document.getElementById("debug-box"),this.mouse_info=new b(this.ctx.canvas),this.camera.onupdate=()=>this.updateBounds(this.ctx.canvas.width,this.ctx.canvas.height),this.debounceSelectedNodeAlphaReset=new R(t=>{if(t&&this.force_quad_tree){t.alpha<.5&&(t.alpha=.5);for(const e of this.force_quad_tree.getNodesInCircularRange(t.pos,300)){const t=this.nodes.get(e.id);t&&t.alpha<.5&&(t.alpha=.6)}}},100),new ResizeObserver(t=>{const e=t[0].target;this.updateBounds(e.clientWidth,e.clientHeight)}).observe(this.ctx.canvas),this.start_btn=document.getElementById("start-btn"),this.start_btn&&this.start_btn.addEventListener("click",()=>{this.is_running?this.stop():this.start()}),this.ctx.canvas.addEventListener("mousedown",t=>this.handleMousePressed(t)),this.ctx.canvas.addEventListener("touchstart",t=>{this.initial_touches=t.touches,1===t.touches.length?this.handleMousePressed(t):this.handleMultiTouch(t)}),this.ctx.canvas.addEventListener("wheel",t=>{this.zoomAt(t.clientX*devicePixelRatio,t.clientY*devicePixelRatio,t.deltaY<0)}),window.addEventListener("mouseup",()=>this.handleMouseUp()),window.addEventListener("touchend",()=>{this.handleMouseUp(),this.pinching_to_zoom=!1}),window.addEventListener("mousemove",t=>this.handleMouseMove(t)),window.addEventListener("touchmove",t=>{L.getReactiveLog("Touch count").set(t.touches[0].identifier.toString()),1===t.touches.length?this.handleMouseMove(t):this.handleMultiTouchMove(t)})}getTransformedPoint(t,e){return new _(t/(this.camera.zoom*devicePixelRatio)+this.camera.x,e/(this.camera.zoom*devicePixelRatio)+this.camera.y)}loop(t){return e=this,s=void 0,n=function*(){const e=this.last_animation_call_time,s=t-this.last_animation_call_time;this.last_animation_call_time=t,this.is_running&&(this.update(s),this.animator.step(s)),this.render(),L.getReactiveLog("FPS").set(this.fps.toString()),L.getReactiveLog("Target FPS").set(this.target_frame_rate.toString()),L.getReactiveLog("ZOOM").set(this.camera.zoom.toString()),L.getReactiveLog("Camera").set(`${this.camera.x}i + ${this.camera.y}j`),L.getReactiveLog("Accumulated Alpha").set(this.accumulated_alpha.toString()),L.getReactiveLog("Nodes").set(this.nodes.size.toString()),L.getReactiveLog("Edges").set(this.edges.size.toString()),L.getReactiveLog("Bounds").set(this.bounds.half_dimension.toString());const i=t-e;this.accumulated_frame_time+=i,this.show_fps&&(this.accumulated_frame_time>=1e3?(this.accumulated_frame_time=0,this.fps=this.fps_counter,this.fps_counter=0):this.fps_counter+=1),requestAnimationFrame(t=>{this.loop(t)})},new((i=void 0)||(i=Promise))(function(t,o){function a(t){try{r(n.next(t))}catch(t){o(t)}}function h(t){try{r(n.throw(t))}catch(t){o(t)}}function r(e){var s;e.done?t(e.value):(s=e.value,s instanceof i?s:new i(function(t){t(s)})).then(a,h)}r((n=n.apply(e,s||[])).next())});var e,s,i,n}start(){this.is_running||(this.is_running=!0,this.last_animation_call_time=performance.now(),this.is_loop_running||this.loop(this.last_animation_call_time).then(()=>this.is_loop_running=!0),this.start_btn.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M14 19V5h4v14zm-8 0V5h4v14z"/></svg>')}stop(){this.render(),this.is_running=!1,this.accumulated_frame_time=0,this.fps=0,this.fps_counter=0,this.start_btn.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M8 17.175V6.825q0-.425.3-.713t.7-.287q.125 0 .263.037t.262.113l8.15 5.175q.225.15.338.375t.112.475t-.112.475t-.338.375l-8.15 5.175q-.125.075-.262.113T9 18.175q-.4 0-.7-.288t-.3-.712"/></svg>'}render(){var t,e;const s=devicePixelRatio||1;if(this.ctx.setTransform(s*this.camera.zoom,0,0,s*this.camera.zoom,-this.camera.x*s*this.camera.zoom,-this.camera.y*s*this.camera.zoom),!this.camera.camera_updated&&!this.bounds_updated&&!this.repaint_drawables)if(this.last_draw_image){if(this.last_draw_image.complete){const t=this.getTransformedPoint(0,0),e=1/(this.camera.zoom*s);return this.ctx.drawImage(this.last_draw_image,t.x,t.y,this.ctx.canvas.width*e,this.ctx.canvas.height*e),void L.getReactiveLog("Rendering").set("False")}}else this.ctx.canvas.toBlob(t=>{t&&(this.last_draw_image=new Image,this.last_draw_image.loading="eager",this.last_draw_image.src=URL.createObjectURL(t))},"image/png",1);L.getReactiveLog("Rendering").set("True"),(this.camera.camera_updated||this.bounds_updated||this.repaint_drawables)&&(this.last_draw_image=null),this.camera.camera_updated=!1,this.repaint_drawables=!1;const i=this.ctx.canvas.width,n=this.ctx.canvas.height;this.ctx.save(),this.ctx.resetTransform(),this.ctx.fillStyle=m.getBgColor("canvas").hex,this.ctx.fillRect(0,0,i,n),this.ctx.beginPath();const o=-this.camera.x*this.camera.zoom*s%(this.grid_size.width*this.camera.zoom*s),a=-this.camera.y*this.camera.zoom*s%(this.grid_size.height*this.camera.zoom*s);this.ctx.strokeStyle=m.getColor("grid").hex,this.ctx.lineWidth=1;for(let t=o;t<i;t+=this.grid_size.width*this.camera.zoom*s)this.ctx.moveTo(t,0),this.ctx.lineTo(t,n);for(let t=a;t<n;t+=this.grid_size.height*this.camera.zoom*s)this.ctx.moveTo(0,t),this.ctx.lineTo(i,t);this.ctx.stroke(),this.ctx.restore(),this.ctx.save();const h=this.edges,r=this.nodes;for(const[,t]of h)t.render();for(const[,e]of r)(null===(t=this.force_quad_tree)||void 0===t?void 0:t.contains(e.pos))&&(null==e||e.render());if(this.force_quad_tree&&(null===(e=this.debug_box_el)||void 0===e?void 0:e.checked)){this.ctx.beginPath(),this.ctx.setLineDash([]),this.ctx.strokeStyle=m.getColor("debug").hex;let t=null;for(const e of this.force_quad_tree.getAllRegions())t=e.boundary,this.ctx.strokeRect(t.center.x-t.half_dimension.width,t.center.y-t.half_dimension.height,2*t.half_dimension.width,2*t.half_dimension.height),e.COM&&this.ctx.fillText(`${e.mass}`,e.COM.x,e.COM.y);this.ctx.closePath()}this.ctx.restore()}update(t){this.accumulated_alpha=0;for(const[,t]of this.nodes)this.accumulated_alpha+=t.alpha;if(0!==this.accumulated_alpha||this.bounds_updated||this.camera.camera_updated){this.force_quad_tree=new N(this.bounds);for(const[,t]of this.nodes)this.force_quad_tree.insert(t.quad_tree_node);L.getReactiveLog("Building quadtree").set("True"),this.repaint_drawables=!0,this.bounds_updated=!1}else L.getReactiveLog("Building quadtree").set("False");if(0!==this.accumulated_alpha){for(const[,e]of this.edges){e.update(t);const s=e.start_node,i=e.end_node,n=B(s,i);s.attr_force.x+=n.x,s.attr_force.y+=n.y,i.attr_force.x-=n.x,i.attr_force.y-=n.y}let e=!1;for(const[e,s]of this.nodes)if(this.drawable_selected!==s&&this.force_quad_tree.contains(s.pos)?this.force_quad_tree&&0!==this.accumulated_alpha&&(s.repln_force=this.force_quad_tree.getTotalForcesOnPoint(s.quad_tree_node,z)):(s.repln_force.set(0,0),s.attr_force.set(0,0)),s.update(t),0===this.accumulated_frame_time){const t=document.getElementById(e);t&&(t.innerHTML=`<div>id: ${s.id}</div><div>alpha: ${s.alpha}</div><div> pos: ${this.getTransformedPoint(s.pos.x,s.pos.y)} </div><div>vel: ${Math.round(1e3*s.velocity.x)/1e3}i + ${Math.round(1e3*s.velocity.y)/1e3}</div><div>force: ${Math.round(1e3*s.force.x)/1e3}i + ${Math.round(1e3*s.force.y)/1e3}</div>`)}e&&this.required_size&&this.updateBounds(this.required_size.width,this.required_size.height)}this.drawable_selected?(this.ctx.canvas.style.cursor="pointer",this.debounceSelectedNodeAlphaReset.call(this.drawable_selected)):this.ctx.canvas.style.cursor="default"}addNode(t,e,s){if(this.nodes.has(t))return!1;const i=new y(this,t,e,s);return this.nodes.set(t,i),this.debounceSelectedNodeAlphaReset.call(i),this.accumulated_alpha+=i.alpha,!0}handleMultiTouchMove(t){if(!this.pinching_to_zoom||2!==t.touches.length)return;if(!this.initial_touches)return void(this.initial_touches=t.touches);const e=(t,e)=>{const s=t.clientX-e.clientX,i=t.clientY-e.clientY;return Math.sqrt(s*s+i*i)},s=e(this.initial_touches[0],this.initial_touches[1]),n=e(t.touches[0],t.touches[1]);if(0===s)return;const o=n/s,a=i.clamp(this.camera.zoom*o,A.MIN_ZOOM,A.MAX_ZOOM),h=(t.touches[0].clientX+t.touches[1].clientX)/2*devicePixelRatio,r=(t.touches[0].clientY+t.touches[1].clientY)/2*devicePixelRatio,c=this.getTransformedPoint(h,r);this.camera.zoom=a;const d=this.getTransformedPoint(h,r);this.camera.x+=c.x-d.x,this.camera.y+=c.y-d.y,this.initial_touches=t.touches}handleMultiTouch(t){2===t.touches.length&&(this.pinching_to_zoom=!0)}handleMouseUp(){this.drawable_selected=null,this.dragging_camera=!1}zoomAt(t,e,s){const n=this.camera.zoom+A.ZOOM_DELTA*this.camera.zoom*(s?1:-1);if(n>A.MAX_ZOOM||n<A.MIN_ZOOM)return;const o=this.camera.zoom,h=this.getTransformedPoint(t,e);this.animator.add(new c((s,n)=>{this.is_zooming=!n,this.camera.x=h.x-t/(devicePixelRatio*s),this.camera.y=h.y-e/(devicePixelRatio*s),this.camera.zoom=i.clamp(s,A.MIN_ZOOM,A.MAX_ZOOM)},o,n,100,a.linear))}addEdge(t,e){const s=this.nodes.get(t),i=this.nodes.get(e);return!(!s||!i||(this.edges.get(p.getEdgeKey(t,e))||(s.alpha=.5,i.alpha=.5,this.edges.set(p.getEdgeKey(t,e),new p(this,s,i))),0))}updateBounds(t,e){const s=1/(devicePixelRatio*this.camera.zoom),i=t*s,n=e*s,o=this.getTransformedPoint(0,0),a=this.getTransformedPoint(i,n),h=a.x-o.x,r=a.y-o.y;this.bounds.updateRect(o.x-100,o.y-100,h+200,r+200),this.bounds_updated=!0}handleMouseMove(t){const e=t instanceof MouseEvent?t:t.touches[0],s=this.getTransformedPoint(e.clientX*devicePixelRatio,e.clientY*devicePixelRatio),i=s.x-this.prev_mouse_pos.x,n=s.y-this.prev_mouse_pos.y;this.drawable_selected?(this.drawable_selected.pos.x+=i,this.drawable_selected.pos.y+=n,this.drawable_selected instanceof y&&this.drawable_selected.position_change.set(i,n),this.prev_mouse_pos.set(s.x,s.y)):this.dragging_camera&&(this.camera.x-=i,this.camera.y-=n,L.getReactiveLog("mouse translate point").set(`${s.x}i+${s.y}j`))}removeNode(t){return this.nodes.delete(t)}highlightNode(t){const e=this.nodes.get(t);return!!e&&(e.highlight(),!0)}unhighlightNode(t){return!1}moveNode(t,e,s){return!1}labelNode(t,e){return!1}handleMousePressed(t){if(!this.nodes)return;const e=t instanceof MouseEvent?t:t.touches[0],s=this.getTransformedPoint(e.clientX*devicePixelRatio,e.clientY*devicePixelRatio);this.prev_mouse_pos.set(s.x,s.y);for(const[,t]of this.nodes)if(t.containsPoint(s.x,s.y)){this.drawable_selected=t;break}this.drawable_selected||(this.dragging_camera=!0)}removeEdge(t,e){return this.edges.delete(p.getEdgeKey(t,e))}highlightEdge(t,e){const s=this.edges.get(p.getEdgeKey(t,e));return!!s&&(s.highlight(),!0)}unhighlightEdge(t,e){return!1}labelEdge(t,e,s){return!1}noop(){return!0}finished(){return!1}error(t){return!1}reset(){return!1}clear(){return this.nodes.clear(),this.edges.clear(),!0}}A.ZOOM_DELTA=.3,A.MIN_ZOOM=.1,A.MAX_ZOOM=10;const S=Math.pow(10,2),k=0,O=1e5,P=1e4;function z(t,e){const s=t.point.subtract(e.point),i=s.length_sqrd(),n=Math.atan2(s.y,s.x),o=O/(i+S)*e.mass*t.mass;return new _(Math.round(o*Math.cos(n)),Math.round(o*Math.sin(n)))}function B(t,e){const s=t.radius+e.radius+k,i=Math.pow(s,2),n=t.pos.subtract(e.pos),o=n.length_sqrd();if(o<.01)return M;const a=P*(o-i);return{x:-Math.round(n.x/o*a),y:-Math.round(n.y/o*a)}}var D=function(t,e,s,i){return new(s||(s=Promise))(function(n,o){function a(t){try{r(i.next(t))}catch(t){o(t)}}function h(t){try{r(i.throw(t))}catch(t){o(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(a,h)}r((i=i.apply(t,e||[])).next())})};class U{constructor(t){this.id=t}execute(t){return D(this,void 0,void 0,function*(){t.highlightNode(this.id)})}}class q{constructor(t,e){this.from_id=t,this.to_id=e}execute(t){return D(this,void 0,void 0,function*(){t.highlightEdge(this.from_id,this.to_id)})}}class F{execute(t){return D(this,void 0,void 0,function*(){t.finished()})}}class H{constructor(t,e){this.finished=!1,this.scene=t,this.step_time_ms=200,this.scene.start(),this.algorithm_name=e,this.generator=null,this.playing=!0}load(t){this.scene.clear();const e=new Set,s=document.getElementById("debug-data");s?s.textContent="":console.error("Debugging panel not found"),function(t,e,s=20){const i=e.ctx.canvas.getBoundingClientRect();let n=i.width/2,o=i.height/2,a=0,h=0,r=1,c=0,d=0,l=0;for(const i of t.getNodes()){let t=a*Math.cos(l)-0*Math.sin(l)+n,u=a*Math.sin(l)+0*Math.cos(l)+o;e.addNode(i,new _(t,u),20),c++,l+=d,c===r&&(h++,a=2*s*h,l=0,c=0,d=Math.acos(1-1/(2*h*h)),r=Math.round(2*Math.PI/d))}}(t,this.scene);for(const i of t.getNodes()){if(s){const t=document.createElement("div");t.id=i.toString(),t.classList.add("node"),s.append(t)}for(const s of t.getNeighbors(i))this.scene.addEdge(i,s),e.add(s);e.add(i)}const i=function*(t,e){const s=[],i=[[null,e]];for(;i.length>0;){const e=i.pop(),n=e[0],o=e[1];if(!s.includes(o)){yield new q(n,o),yield new U(o),s.push(o);for(const e of t.getNeighbors(o))s.includes(e)||i.push([o,e])}}return new F}(t,t.start_node),n=setInterval(()=>{const t=i.next();t.done?clearInterval(n):t.value.execute(this.scene)},this.step_time_ms)}stop(){}reset(){}start(){}}class ${constructor(t,e=!0){this.start_node=t,this.bidirectional=e,this.adjacency_mapping=new Map,this.addNode(t)}addNode(t){return this.adjacency_mapping.has(t)||this.adjacency_mapping.set(t,new Set),this}attach(t,e){var s;this.addNode(t);let i=this.adjacency_mapping.get(t);for(const n of e)this.addNode(n),null==i||i.add(n),this.bidirectional&&(null===(s=this.adjacency_mapping.get(n))||void 0===s||s.add(t));return this}getNeighbors(t){var e;return Array.from(null!==(e=this.adjacency_mapping.get(t))&&void 0!==e?e:[])}getNodes(){return Array.from(this.adjacency_mapping.keys())}toString(){let t="";for(const[e,s]of this.adjacency_mapping.entries())t+=`${e} → ${[...s].join(", ")}`;return t}}const G=new $("A").attach("A",["B","C","D"]).attach("B",["E","F"]),W=new $("Cluster1").attach("Cluster1",["C1A","C1B","C1C"]).attach("C1A",["C1B","C1C"]).attach("C1B",["C1C"]).attach("Cluster2",["C2A","C2B","C2C"]).attach("C2A",["C2B","C2C"]).attach("C2B",["C2C"]).attach("Cluster3",["C3A","C3B","C3C"]).attach("C3A",["C3B","C3C"]).attach("C3B",["C3C"]).attach("Cluster1",["Cluster2"]).attach("Cluster2",["Cluster3"]),Y=new $("Center").attach("Center",["N1","N2","N3","N4","N5","N6"]).attach("N1",["N2","N6"]).attach("N2",["N1","N3"]).attach("N3",["N2","N4"]).attach("N4",["N3","N5"]).attach("N5",["N4","N6"]).attach("N6",["N5","N1"]),j=new $("C1N1").attach("C1N1",["C1N2","C1N3","C1N4"]).attach("C1N2",["C1N5","C1N6"]).attach("C1N3",["C1N7","C1N8"]).attach("C1N4",["C1N9","C1N10"]).attach("C2N1",["C2N2","C2N3","C2N4"]).attach("C2N2",["C2N5","C2N6"]).attach("C2N3",["C2N7","C2N8"]).attach("C2N4",["C2N9","C2N10"]).attach("C3N1",["C3N2","C3N3","C3N4"]).attach("C3N2",["C3N5","C3N6"]).attach("C3N3",["C3N7","C3N8"]).attach("C3N4",["C3N9","C3N10"]).attach("C4N1",["C4N2","C4N3","C4N4"]).attach("C4N2",["C4N5","C4N6"]).attach("C4N3",["C4N7","C4N8"]).attach("C4N4",["C4N9","C4N10"]).attach("C5N1",["C5N2","C5N3","C5N4"]).attach("C5N2",["C5N5","C5N6"]).attach("C5N3",["C5N7","C5N8"]).attach("C5N4",["C5N9","C5N10"]).attach("C6N1",["C6N2","C6N3","C6N4"]).attach("C6N2",["C6N5","C6N6"]).attach("C6N3",["C6N7","C6N8"]).attach("C6N4",["C6N9","C6N10"]).attach("C7N1",["C7N2","C7N3","C7N4"]).attach("C7N2",["C7N5","C7N6"]).attach("C7N3",["C7N7","C7N8"]).attach("C7N4",["C7N9","C7N10"]).attach("C8N1",["C8N2","C8N3","C8N4"]).attach("C8N2",["C8N5","C8N6"]).attach("C8N3",["C8N7","C8N8"]).attach("C8N4",["C8N9","C8N10"]).attach("C9N1",["C9N2","C9N3","C9N4"]).attach("C9N2",["C9N5","C9N6"]).attach("C9N3",["C9N7","C9N8"]).attach("C9N4",["C9N9","C9N10"]).attach("C10N1",["C10N2","C10N3","C10N4"]).attach("C10N2",["C10N5","C10N6"]).attach("C10N3",["C10N7","C10N8"]).attach("C10N4",["C10N9","C10N10"]).attach("C1N1",["C2N1"]).attach("C2N1",["C3N1"]).attach("C3N1",["C4N1"]).attach("C4N1",["C5N1"]).attach("C5N1",["C6N1"]).attach("C6N1",["C7N1"]).attach("C7N1",["C8N1"]).attach("C8N1",["C9N1"]).attach("C9N1",["C10N1"]);class X{}X.MIN_SCREEN_WIDTH=740;const V='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M5 19h2q.425 0 .713.288T8 20t-.288.713T7 21H4q-.425 0-.712-.288T3 20v-3q0-.425.288-.712T4 16t.713.288T5 17zm14 0v-2q0-.425.288-.712T20 16t.713.288T21 17v3q0 .425-.288.713T20 21h-3q-.425 0-.712-.288T16 20t.288-.712T17 19zM5 5v2q0 .425-.288.713T4 8t-.712-.288T3 7V4q0-.425.288-.712T4 3h3q.425 0 .713.288T8 4t-.288.713T7 5zm14 0h-2q-.425 0-.712-.288T16 4t.288-.712T17 3h3q.425 0 .713.288T21 4v3q0 .425-.288.713T20 8t-.712-.288T19 7z"/></svg>',Z='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M6 18H4q-.425 0-.712-.288T3 17t.288-.712T4 16h3q.425 0 .713.288T8 17v3q0 .425-.288.713T7 21t-.712-.288T6 20zm12 0v2q0 .425-.288.713T17 21t-.712-.288T16 20v-3q0-.425.288-.712T17 16h3q.425 0 .713.288T21 17t-.288.713T20 18zM6 6V4q0-.425.288-.712T7 3t.713.288T8 4v3q0 .425-.288.713T7 8H4q-.425 0-.712-.288T3 7t.288-.712T4 6zm12 0h2q.425 0 .713.288T21 7t-.288.713T20 8h-3q-.425 0-.712-.288T16 7V4q0-.425.288-.712T17 3t.713.288T18 4z"/></svg>';document.addEventListener("DOMContentLoaded",()=>{let t=!0;const e=document.getElementById("canvas-container"),s=document.getElementById("main-canvas"),i=s.getContext("2d",{alpha:!1});if(!s)return;if(!i)return;const n=document.getElementById("toggle-btn"),o=document.getElementById("data-container"),a=document.getElementById("slider"),h=new A(i,!0);function r(){window.innerWidth>X.MIN_SCREEN_WIDTH?(null==e||e.classList.remove("hidden"),null==o||o.classList.remove("hidden"),t=!0):t?(null==e||e.classList.remove("hidden"),null==o||o.classList.add("hidden"),t=!0):(null==e||e.classList.add("hidden"),null==o||o.classList.remove("hidden"),t=!1),window.innerWidth<=X.MIN_SCREEN_WIDTH&&(t?h.start():h.stop())}function c(t){if(!e)return;const s=window.devicePixelRatio||1,i=e.getBoundingClientRect(),n=t.getTransform();t.canvas.width=Math.round(i.width*s),t.canvas.height=Math.round(i.height*s),t.setTransform(n),L.getReactiveLog("CanvasSize").set(`${t.canvas.offsetWidth}x${t.canvas.offsetHeight}`),L.getReactiveLog("CanvasContainerSize").set(`${e.offsetWidth}x${e.offsetHeight}`),h.render()}!function(){const t=document.getElementById("fullscreen-btn");let e=!1;null==t||t.addEventListener("click",()=>{e=null!==document.fullscreenElement,e?document.exitFullscreen().then(()=>{t.innerHTML=V,e=!1}):document.body.requestFullscreen().then(()=>{t.innerHTML=Z,e=!0})}),document.body.addEventListener("fullscreenchange",s=>{e=null!==document.fullscreenElement,t.innerHTML=e?Z:V})}(),window.addEventListener("resize",()=>{e.style.width="",r(),c(i)}),window.addEventListener("orientationchange",()=>{e.style.width="",r(),c(i)});let d=!1;null==a||a.addEventListener("mousedown",()=>{document.body.style.cursor="ew-resize",d=!0}),null==a||a.addEventListener("touchstart",()=>{d=!0}),window.addEventListener("mouseup",()=>{d=!1,document.body.style.cursor="default",c(i)}),window.addEventListener("touchend",()=>{d=!1,c(i)}),window.addEventListener("mousemove",t=>{if(e&&!(window.innerWidth<=X.MIN_SCREEN_WIDTH)&&d&&t.clientX<window.innerWidth&&t.clientX>0){const s=t.pageX;e.style.width=`${s}px`,c(i),t.preventDefault(),t.stopImmediatePropagation()}}),window.addEventListener("touchmove",t=>{const s=t.touches[0];if(e&&!(window.innerWidth<=X.MIN_SCREEN_WIDTH)&&d&&s.clientX<window.innerWidth&&s.clientX>0){const n=s.pageX;e.style.width=`${n}px`,c(i),t.preventDefault(),t.stopImmediatePropagation()}}),null==n||n.addEventListener("click",()=>{t?(null==e||e.classList.add("hidden"),null==o||o.classList.remove("hidden")):(null==e||e.classList.remove("hidden"),null==o||o.classList.add("hidden")),t=!t,t?h.start():h.stop()}),m.setThemeType(l.AUTO),e&&a&&window.innerWidth>X.MIN_SCREEN_WIDTH&&(e.style.width=`${a.getBoundingClientRect().x}px`),c(i),r();const u=new H(h,"DFS Graph Traversal"),_=document.getElementById("config-dropdown");if(_){const t={simple:G,"clustered small":W,"spider web":Y,"large clustered":j};for(const e in t){const t=document.createElement("option");t.innerText=e,_.appendChild(t)}_.value=_.options[3].value,u.load(t[_.value]),_.addEventListener("change",()=>{u.load(t[_.value]),console.log("changing")})}}),function(t,e=[]){const i=new s("\nlet&100\nlet y = 20;\nlet result = x + y * 2 - 5 / (3 + 1);\n\nif (result >= 25 and result != 30) {\n    result += 5;\n} else {\n    result -= 2;\n}\n\nfn square(n) {\n    return n ** 2;\n}\n\nlet flag = true;\nwhile (flag) {\n    x--;\n    if (x <= 0) {\n        flag = false;\n        break;\n    }\n}\n\n"),n=i.getTokens(),o=n.length===e.length&&n.every((t,s)=>t.token_type===e[s].token_type&&t.literal===e[s].literal);console.log(o?"✅ Test passed":"❌ Test failed"),console.log("Expected:",e),console.log("Got     :",n);for(const t of i.errors)console.error(t.message+"\n"+t.highlight)}()})();