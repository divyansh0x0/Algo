(()=>{"use strict";class t{static roundedClamp(e,s,i){return t.clamp(Math.round(e),s,i)}static clamp(t,e,s){return Math.max(Math.min(t,s),e)}}class e{constructor(...s){if("string"==typeof s[0]){this.hex=s[0];const{r:t,g:i,b:n,a:o}=e.hexToRgba(this.hex);this.r=t,this.g=i,this.b=n,this.a=o}else{const[i=0,n=0,o=0,h=1]=s;this.r=i,this.g=t.clamp(n,0,255),this.b=t.clamp(o,0,255),this.a=t.clamp(h,0,255),this.hex=e.getHex(i,n,o,h)}}static hexToRgba(t){if(t=t.replace(/^#/,""),![3,4,6,8].includes(t.length))throw new Error("Invalid hex color code"+t+". Must be 3, 4, 6, or 8 digits.");3!==t.length&&4!==t.length||(t=t.split("").map(t=>t+t).join(""));let e,s,i,n=1;return 6===t.length?(e=parseInt(t.slice(0,2),16),s=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16)):(e=parseInt(t.slice(0,2),16),s=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16),n=parseInt(t.slice(6,8),16)/255),n=Math.round(100*n)/100,{r:e,g:s,b:i,a:n}}static getHex(t,e,s,i){return`#${t.toString(16).padStart(2,"0")}${e.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${i?Math.round(255*i).toString(16).padStart(2,"0"):""}`}toString(){return 1===this.a?`rgb(${this.r}, ${this.g}, ${this.b})`:`rgba(${this.r}, ${this.g}, ${this.b}, ${this.a.toFixed(2)})`}}function s(t,e,s,i){return t===e?e:t+(e-t)*i(s)}class i{static linear(t){return t}static easeInSin(t){return 1-Math.cos(t*Math.PI/2)}static easeOutSin(t){return Math.sin(t*Math.PI/2)}static easeInOutSin(t){return(1-Math.cos(t*Math.PI))/2}static easeInCubic(t){return Math.pow(t,3)}static easeOutCubic(t){return 1-Math.pow(1-t,3)}static easeInOutCubic(t){return t<.5?4*Math.pow(t,3):1-Math.pow(1-t,3)}static easeInQuad(t){return t*t}static easeOutQuad(t){return 1-Math.pow(1-t,2)}static easeInOutQuad(t){return t<.5?2*Math.pow(t,2):1-Math.pow(1-t,2)}}class n{constructor(t,e,s){this.total_duration_ms=e,this.duration_passed_ms=0,this.easing=s,this.drawable=t}getId(){return this.constructor.name+this.drawable.id}}class o extends n{constructor(t,e,s,n=250,o=i.easeInOutSin){super(t,n,o),this.from=e,this.to=s,this.drawable.is_color_animating=!0}setNormalizedTime(i){const n=t.roundedClamp(s(this.from.r,this.from.r,i,this.easing),0,255),o=t.roundedClamp(s(this.from.g,this.from.g,i,this.easing),0,255),h=t.roundedClamp(s(this.from.b,this.from.b,i,this.easing),0,255),a=t.roundedClamp(s(this.from.a,this.from.a,i,this.easing),0,255);this.drawable.color=new e(n,o,h,a)}finalize(){this.setNormalizedTime(1),this.drawable.is_color_animating=!1,this.drawable.color=this.to,this.interrupt()}interrupt(){this.drawable.is_color_animating=!1}}var h,a;!function(t){t[t.LIGHT=0]="LIGHT",t[t.DARK=1]="DARK",t[t.AUTO=2]="AUTO"}(h||(h={})),function(t){t.DEFAULT="default",t.HIGHLIGHTED="highlighted",t.SELECTED="selected",t.HOVER="hover",t.ON_BACKGROUND="on-background",t.ON_PRIMARY="on-primary",t.ON_SECONDARY="on-secondary",t.BORDER="border"}(a||(a={}));const r=function(){const t="theme";let s=!1,i=!1,n=getComputedStyle(document.documentElement);function o(){n=getComputedStyle(document.documentElement),console.log("theme updated",n)}return{setThemeType:e=>{switch(n=getComputedStyle(document.documentElement),s=!1,e){case h.LIGHT:document.documentElement.setAttribute(t,"light");break;case h.DARK:document.documentElement.setAttribute(t,"dark");break;case h.AUTO:!function(){if(window.matchMedia){const e=window.matchMedia("(prefers-color-scheme: dark)");if(s=!0,e.matches?(document.documentElement.setAttribute(t,"dark"),console.log("Dark theme enabled")):document.documentElement.setAttribute(t,"light"),i)return;e.addEventListener("change",e=>{if(i=!0,s){if(o(),e.matches)return document.documentElement.setAttribute(t,"dark"),void console.log("Dark theme enabled");document.documentElement.setAttribute(t,"light")}})}else console.log("No support for matchMedia. Defaulting to light theme"),document.documentElement.setAttribute(t,"light")}()}o()},getBgColor(t,s=a.DEFAULT){const i=`--${t}-bg-${s}-color`,o=n.getPropertyValue(i);return""===o&&console.error(i," is not defined."),new e(o)},getFgColor(t,s=a.DEFAULT){const i=`--${t}-fg-${s}-color`,o=n.getPropertyValue(i);return""===o&&console.error(i," is not defined."),new e(o)},getTextColor(t=a.ON_BACKGROUND){const s=`--text-${t}-color`,i=n.getPropertyValue(s);return""===i&&console.error(s," is not defined."),new e(i)},getColor(t){const s=`--${t}-color`,i=n.getPropertyValue(s);return""===i&&console.error(s," is not defined."),new e(i)}}}();class c{constructor(t=0,e=0){this.x=t,this.y=e}copy(){return new c(this.x,this.y)}length_sqrd(){return this.x*this.x+this.y*this.y}set(t,e){return this.x=t,this.y=e,this}add(t){return new c(this.x+t.x,this.y+t.y)}addXY(t,e){return new c(this.x+t,this.y+e)}add_self(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return new c(this.x-t.x,this.y-t.y)}subXY(t,e){return new c(this.x-t,this.y-e)}sub_self(t){return this.x-=t.x,this.y-=t.y,this}scale(t,e){return e||(e=t),new c(this.x*t,this.y*e)}scale_self(t,e){return e||(e=t),this.x*=t,this.y*=t,this}dot(t){return this.x*t.x+this.y*t.y}toString(){return this.x+"i + "+this.y+"j"}}c.unit_x=Object.freeze(new c(1,0)),c.unit_y=Object.freeze(new c(0,1)),c.ZERO=Object.freeze(new c(0,0));class d{constructor(t,e){this.width=t,this.height=e}scale(t){return new d(this.width*t,this.height*t)}scale_self(t){return this.width*=t,this.height*=t,this}max(){return Math.max(this.width,this.height)}toString(){return this.width+"x"+this.height+"j"}}d.ZERO=Object.freeze(new d(0,0));class l{constructor(t,e){this.pos=new c(0,0),this.is_color_animating=!1,this.ctx=t,this.id=e,this.color_state=a.DEFAULT,this.color=r.getBgColor(this.getName(),this.color_state)}highlight(){N.animator.add(new o(this,this.color,r.getBgColor(this.getName(),a.HIGHLIGHTED))),this.color_state=a.HIGHLIGHTED}getName(){return this.constructor.name.toLowerCase()}update(t){this.is_color_animating||(this.color=r.getBgColor(this.getName(),this.color_state))}drawPointVec(t,e="green"){const s=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));s>1&&this.drawArrow(100*t.x/s,100*t.y/s,e)}drawArrow(t,e,s="green"){if(0===t&&0===e)return;this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.lineCap="round",this.ctx.strokeStyle=s,this.ctx.moveTo(this.pos.x,this.pos.y);const i=this.pos.add(new c(t,e));this.ctx.lineTo(i.x,i.y),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()}drawCircle(t,e,s,i,n=!1,o,h=1){if(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(e,s,t,0,2*Math.PI),this.ctx.fillStyle=i,n){let t=this.ctx.strokeStyle;this.ctx.lineWidth=h,this.ctx.strokeStyle=o,this.ctx.strokeStyle=t,this.ctx.stroke()}this.ctx.fill(),this.ctx.closePath(),this.ctx.restore()}reset(){console.error("Reset not implemented for",this.constructor.name)}drawLine(t,e,s,i,n,o){this.ctx.save(),this.ctx.strokeStyle=o,this.ctx.lineWidth=n,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(s,i),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()}drawText(t,e,s,i,n=1){this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.font=`${n}em Arial`,this.ctx.fillStyle=i,this.ctx.fillText(t,e,s),this.ctx.restore()}drawRect(t,e,s,i,n="#000",o,h=0,a){this.ctx.save(),this.ctx.fillStyle=n,h>0&&(this.ctx.strokeStyle=o),this.ctx.beginPath(),this.ctx.roundRect(300,5,200,100,a),this.ctx.closePath(),this.ctx.restore()}}class u extends l{constructor(t,e,s){super(t,u.getEdgeKey(e.id,s.id)),this.start_node=e,this.end_node=s}static getEdgeKey(t,e){return[t,e].sort().join()}render(){this.drawLine(this.start_node.pos.x,this.start_node.pos.y,this.end_node.pos.x,this.end_node.pos.y,u.thickness,this.color.hex)}}u.thickness=2;class m{constructor(t,e){this.center=t,this.half_dimension=e}static fromRect(t,e,s,i){return new m(new c(t+s/2,e+i/2),new d(s/2,i/2))}update(t,e){this.center=t,this.half_dimension=e}containsPoint(t){return Math.abs(t.x-this.center.x)<this.half_dimension.width&&Math.abs(t.y-this.center.y)<this.half_dimension.height}intersectsAABB(t){return this.center.x-t.center.x<this.half_dimension.width+t.half_dimension.width&&this.center.y-t.center.y<this.half_dimension.height+t.half_dimension.height}toString(){return`${this.center} ${this.half_dimension}`}}class g{constructor(t,e,s=10){this.id=t,this.point=e,this.mass=s}}setInterval(()=>{var t;C.MIN_THRESHOLD=1-(null===(t=document.getElementById("threshold-slider"))||void 0===t?void 0:t.valueAsNumber)},100);class C{constructor(t){this.mass=0,this.regions=[],this.has_sub_divisions=!1,this.region_name="",this.boundary=t,this.has_sub_divisions=!1}subdivide(){const t=this.boundary.half_dimension,e=this.boundary.center,s=new C(new m(new c(e.x+t.width/2,e.y-t.height/2),this.boundary.half_dimension.scale(.5))),i=new C(new m(new c(e.x-t.width/2,e.y-t.height/2),this.boundary.half_dimension.scale(.5))),n=new C(new m(new c(e.x-t.width/2,e.y+t.height/2),this.boundary.half_dimension.scale(.5))),o=new C(new m(new c(e.x+t.width/2,e.y+t.height/2),this.boundary.half_dimension.scale(.5)));this.regions.push(s,i,n,o),this.has_sub_divisions=!0}insert(t){var e,s;if(!this.boundary.containsPoint(t.point))return!1;if(!this.node&&!this.has_sub_divisions)return this.node=t,this.COM=t.point.copy(),this.mass=t.mass,!0;this.has_sub_divisions||this.subdivide(),this.region_name="";let i=!1;for(const t of this.regions)!i&&this.node&&t.insert(this.node)&&(i=!0,this.node=void 0),this.region_name+=null!==(s=null===(e=t.node)||void 0===e?void 0:e.id)&&void 0!==s?s:"";let n=!1;for(const e of this.regions)if(e.insert(t)){n=!0;break}if(n){const e=this.mass+t.mass;if(!this.COM)return!0;this.COM.scale_self(this.mass).add_self(t.point.scale(t.mass)).scale_self(1/e),this.mass=e}return n}getTotalForcesOnPoint(t,e){if(0===this.regions.length)return new c(0,0);const s=new c(0,0),i=this.getNodesInCircularRange(t.point,C.FULL_ACCURACY_CIRCLE_RADIUS);for(const n of i)t.id!=n.id&&s.add_self(e(t,n));return s.add_self(this.getForceDueToRegions(t,e,i)),s}getForceDueToRegions(t,e,s=[],i=0){const n=new c(0,0);for(const o of this.regions){if(!o.COM||0===o.mass)continue;const h=o.COM.x-t.point.x,a=o.COM.y-t.point.y;let r=h*h+a*a;if(o.boundary.half_dimension.width/Math.sqrt(r)>C.MIN_THRESHOLD&&o.has_sub_divisions)n.add_self(o.getForceDueToRegions(t,e,s,i+1));else{if(Math.abs(h)<1e-6&&Math.abs(a)<1e-6)continue;const s=new g(o.region_name,o.COM,o.mass);n.add_self(e(t,s))}}return n}getNodesInRange(t){const e=[];if(!this.boundary.intersectsAABB(t))return e;if(!this.has_sub_divisions)return this.node&&t.containsPoint(this.node.point)&&e.push(this.node),e;for(const s of this.regions)e.push(...s.getNodesInRange(t));return e}getNodesInCircularRange(t,e){const s=[];if(!function(t,e,s){const i=s.center.x-s.half_dimension.width,n=s.center.x+s.half_dimension.width,o=s.center.y-s.half_dimension.height,h=s.center.y+s.half_dimension.height,a=Math.max(i,Math.min(t.x,n)),r=Math.max(o,Math.min(t.y,h)),c=t.x-a,d=t.y-r;return c*c+d*d<=e*e}(t,e,this.boundary))return s;if(!this.has_sub_divisions)return this.node&&function(t,e,s){const i=t.x-s.x,n=t.y-s.y;return i*i+n*n<=e*e}(t,e,this.node.point)&&s.push(this.node),s;for(const i of this.regions)s.push(...i.getNodesInCircularRange(t,e));return s}*getAllRegions(){if(yield this,this.has_sub_divisions)for(const t of this.regions)yield*t.getAllRegions()}toString(){}}C.MIN_THRESHOLD=.9,C.FULL_ACCURACY_AREA=new d(100,100),C.FULL_ACCURACY_CIRCLE_RADIUS=100;class _ extends l{constructor(t,e,s,i,n=""){super(t,e),this.attr_force=new c(0),this.repln_force=new c(0),this.alpha=1,this.velocity=new c(0),this.force=new c(0),this.max_velocity=100,this.velocity_decay=.5,this.min_velocity=1,this.pos.set(s.x,s.y),this.text=n,this.radius=i,this.mass=1,this.quad_tree_node=new g(e,this.pos,100)}update(e){super.update(20);const s=.02;this.force.x=this.attr_force.x+this.repln_force.x,this.force.y=this.attr_force.y+this.repln_force.y,this.force.scale_self(this.alpha);let i=t.clamp(this.force.x*s,-this.max_velocity,this.max_velocity),n=t.clamp(this.force.y*s,-this.max_velocity,this.max_velocity);this.velocity.x+=i,this.velocity.y+=n,this.velocity.scale_self(1-this.velocity_decay),Math.abs(this.velocity.x)<this.min_velocity&&(this.velocity.x=0),Math.abs(this.velocity.y)<this.min_velocity&&(this.velocity.y=0);const o=this.velocity.x*s,h=this.velocity.y*s;this.pos.x+=o,this.pos.y+=h,this.alpha-=this.alpha*_.alphaDecay,this.alpha<.001&&(this.alpha=0),this.repln_force.set(0,0),this.attr_force.set(0,0)}render(){this.drawCircle(this.radius,this.pos.x,this.pos.y,this.color.hex,!0,r.getBgColor(this.getName(),a.BORDER).hex,1),this.drawText(this.id,this.pos.x,this.pos.y,r.getTextColor(a.ON_PRIMARY).hex)}getDistanceFromPoint(t){const e=this.pos.subtract(t).length_sqrd();return Math.sqrt(e)}containsPoint(t){const e=this.pos.subtract(t).length_sqrd();return Math.pow(this.radius,2)>e}}var f;_.alphaDecay=.002,function(t){t[t.Primary=0]="Primary",t[t.Auxiliary=1]="Auxiliary",t[t.Secondary=2]="Secondary"}(f||(f={}));class p{constructor(t){this.location=new c,this.buttonsPressed=new Set,this.touches=[],this.isTouching=!1,this.onMouseMove=t=>{const e=this.element.getBoundingClientRect();this.location=new c(t.clientX-e.x,t.clientY-e.y)},this.onMouseDown=t=>{this.buttonsPressed.add(t.button)},this.onMouseUp=t=>{this.buttonsPressed.delete(t.button)},this.onTouchStart=t=>{t.preventDefault();const e=this.element.getBoundingClientRect();this.isTouching=!0,this.touches=Array.from(t.touches).map(t=>new c(t.clientX-e.x,t.clientY-e.y)),this.location=this.touches[0]},this.onTouchMove=t=>{const e=this.element.getBoundingClientRect();this.touches=Array.from(t.touches).map(t=>new c(t.clientX-e.x,t.clientY-e.y)),this.location=this.touches[0]},this.onTouchEnd=t=>{const e=this.element.getBoundingClientRect();this.touches=Array.from(t.touches).map(t=>new c(t.clientX-e.x,t.clientY-e.y)),this.isTouching=this.touches.length>0,this.touches.length>0&&(this.location=this.touches[0])},this.element=t,window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchstart",this.onTouchStart,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd),window.addEventListener("touchcancel",this.onTouchEnd)}isButtonDown(t){return this.buttonsPressed.has(t)}dispose(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),window.removeEventListener("touchcancel",this.onTouchEnd)}}const x=Object.freeze({x:0,y:0});class N{constructor(t,e=!1){this.ctx=t,this.show_fps=e,this.is_everything_bounded=!0,this.nodes=new Map,this.edges=new Map,this.accumulated_time=0,this.fps=0,this.k_repl=1e7,this.last_animation_call_time=0,this.drawable_selected=null,this.grid_size=new d(100,100),this.prev_mouse_pos=new c,this.fps_counter=0,this.accumulated_alpha=1,this.offset=new c(0),this.show_fps=e,this.is_running=!1,this.debug_box_el=document.getElementById("debug-box"),this.mouse_info=new p(this.ctx.canvas),new ResizeObserver(t=>{for(const[t,e]of this.nodes)e.alpha=.9}).observe(this.ctx.canvas)}highlight(t){t.highlight()}loop(t){if(!this.is_running)return;const e=this.last_animation_call_time,s=t-this.last_animation_call_time;this.last_animation_call_time=t,this.update(s),this.render();const i=t-e;this.accumulated_time+=i,this.show_fps&&(this.accumulated_time>=1e3&&(this.accumulated_time=0,this.fps=this.fps_counter,this.fps_counter=0),this.fps_counter+=1),requestAnimationFrame(t=>{this.loop(t)})}start(){return t=this,e=void 0,i=function*(){this.is_running||(this.is_running=!0,this.last_animation_call_time=performance.now(),this.accumulated_time=0,this.prev_mouse_pos=this.mouse_info.location,this.loop(this.last_animation_call_time))},new((s=void 0)||(s=Promise))(function(n,o){function h(t){try{r(i.next(t))}catch(t){o(t)}}function a(t){try{r(i.throw(t))}catch(t){o(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(h,a)}r((i=i.apply(t,e||[])).next())});var t,e,s,i}stop(){this.is_running=!1}render(){var t,e;this.ctx.save();const s=this.ctx.canvas.getBoundingClientRect();this.ctx.clearRect(0,0,s.width,s.height),this.ctx.fillStyle=r.getBgColor("canvas").hex,this.ctx.fillRect(0,0,s.width,s.height),this.ctx.save(),this.ctx.strokeStyle=r.getColor("grid").hex;for(let t=0;t<s.width;t+=this.grid_size.width)this.ctx.moveTo(t,0),this.ctx.lineTo(t,s.height);for(let t=0;t<s.height;t+=this.grid_size.height)this.ctx.moveTo(0,t),this.ctx.lineTo(s.width,t);this.ctx.stroke(),this.ctx.restore();const i=this.edges,n=this.nodes;for(const[t,e]of i)e.render();this.ctx.fillStyle=r.getTextColor(a.ON_BACKGROUND).hex,this.ctx.font="1em Arial",this.ctx.strokeStyle="#0f0",this.ctx.setLineDash([2,3]);for(const[e,s]of n)s&&(s.render(),(null===(t=this.debug_box_el)||void 0===t?void 0:t.checked)&&(this.ctx.beginPath(),this.ctx.arc(s.pos.x,s.pos.y,C.FULL_ACCURACY_CIRCLE_RADIUS,0,2*Math.PI),this.ctx.closePath(),this.ctx.stroke()));if(this.ctx.setLineDash([]),this.ctx.strokeStyle=r.getColor("debug").hex,this.show_fps&&(this.ctx.fillStyle=r.getTextColor(a.ON_BACKGROUND).hex,this.ctx.textAlign="left",this.ctx.font="1em Arial",this.ctx.textBaseline="top",this.ctx.fillText(`FPS: ${this.fps}`,10,10),this.ctx.fillText(`Accuracy: ${Math.round(1e4*(1-C.MIN_THRESHOLD))/100}%`,10,30),this.bounds&&this.ctx.fillText(`Bounds ${Math.round(this.bounds.width)}x${Math.round(this.bounds.height)}`,10,50),this.ctx.fillText(`Nodes: ${this.nodes.size}`,10,70),this.ctx.fillText(`Edges: ${this.edges.size}`,10,90)),null===(e=this.debug_box_el)||void 0===e?void 0:e.checked){if(this.force_quad_tree){this.ctx.beginPath();let t=null;for(const e of this.force_quad_tree.getAllRegions())t=e.boundary,this.ctx.strokeRect(t.center.x-t.half_dimension.width,t.center.y-t.half_dimension.height,2*t.half_dimension.width,2*t.half_dimension.height),e.COM&&this.ctx.fillText(`${e.mass}`,e.COM.x,e.COM.y);this.ctx.closePath()}this.ctx.restore()}else this.ctx.restore()}update(e){if(this.ctx.resetTransform(),this.bounds=this.ctx.canvas.getBoundingClientRect(),0!==this.accumulated_alpha){this.force_quad_tree=new C(m.fromRect(0,0,this.bounds.width,this.bounds.height));for(const[t,e]of this.nodes)this.force_quad_tree.insert(e.quad_tree_node)}for(const[t,s]of this.edges){s.update(e);const t=s.start_node,i=s.end_node,n=M(t.pos,i.pos);t.attr_force.x+=n.x,t.attr_force.y+=n.y,i.attr_force.x-=n.x,i.attr_force.y-=n.y}this.accumulated_alpha=0;for(const[s,i]of this.nodes){if(!this.drawable_selected&&i.containsPoint(this.mouse_info.location)&&this.mouse_info.isButtonDown(f.Primary)&&(this.drawable_selected=i),this.force_quad_tree&&(i.repln_force=this.force_quad_tree.getTotalForcesOnPoint(i.quad_tree_node,b)),i.update(e),this.is_everything_bounded&&(i.pos.x=t.clamp(i.pos.x,i.radius,this.bounds.width-i.radius),i.pos.y=t.clamp(i.pos.y,i.radius,this.bounds.height-i.radius)),0===this.accumulated_time){const t=document.getElementById(s);t&&(t.innerHTML=`<div>id: ${i.id}</div><div>alpha: ${i.alpha}</div><div> pos: ${Math.round(i.pos.x)}i + ${Math.round(i.pos.y)}j </div><div>vel: ${Math.round(1e3*i.velocity.x)/1e3}i + ${Math.round(1e3*i.velocity.y)/1e3}</div><div>force: ${Math.round(1e3*i.force.x)/1e3}i + ${Math.round(1e3*i.force.y)/1e3}</div>`)}this.accumulated_alpha+=i.alpha,i.pos.add_self(this.offset)}this.drawable_selected?(this.ctx.canvas.style.cursor="pointer",this.drawable_selected.pos.x=this.mouse_info.location.x,this.drawable_selected.pos.y=this.mouse_info.location.y,this.mouse_info.isButtonDown(f.Primary)||(this.ctx.canvas.style.cursor="default",this.drawable_selected=null)):this.mouse_info.isButtonDown(f.Primary)?(this.ctx.canvas.style.cursor="move",this.offset.add_self(this.prev_mouse_pos.subtract(this.mouse_info.location).scale_self(-1))):this.ctx.canvas.style.cursor="default",this.prev_mouse_pos=this.mouse_info.location,N.animator.step(e)}addNode(t,e,s){return!this.nodes.has(t)&&(this.nodes.set(t,new _(this.ctx,t,e,s)),!0)}removeNode(t){return this.nodes.delete(t)}highlightNode(t){const e=this.nodes.get(t);return!!e&&(this.highlight(e),!0)}unhighlightNode(t){return!1}moveNode(t,e,s){return!1}labelNode(t,e){return!1}addEdge(t,e){const s=this.nodes.get(t),i=this.nodes.get(e);return!(!s||!i||(this.edges.set(u.getEdgeKey(t,e),new u(this.ctx,s,i)),0))}removeEdge(t,e){const s=this.nodes.get(t),i=this.nodes.get(e);return!(!s||!i)&&this.edges.delete(u.getEdgeKey(t,e))}highlightEdge(t,e){return!1}unhighlightEdge(t,e){return!1}labelEdge(t,e,s){return!1}noop(){return!0}finished(){return!1}error(t){return!1}reset(){return!1}clear(){return this.nodes.clear(),this.edges.clear(),!0}}N.animator=new class{constructor(){this.animations_map=new Map}add(t){var e;const s=t.getId();this.animations_map.has(s)&&(null===(e=this.animations_map.get(s))||void 0===e||e.interrupt()),this.animations_map.set(s,t)}step(t){for(const e in this.animations_map){const s=this.animations_map.get(e);if(!s)continue;if(s.duration_passed_ms+=t,s.duration_passed_ms>s.total_duration_ms){s.duration_passed_ms=s.total_duration_ms,s.finalize(),this.animations_map.delete(e);break}const i=s.duration_passed_ms/s.total_duration_ms;s.setNormalizedTime(i)}}},N.LOCATION_ERROR=5;const w=Math.pow(10,2),y=1e4,v=1500;function b(t,e){const s=t.point.subtract(e.point),i=s.length_sqrd(),n=Math.atan2(s.y,s.x),o=y/(i+w)*e.mass*t.mass;return new c(Math.round(o*Math.cos(n)),Math.round(o*Math.sin(n)))}function M(t,e){const s=t.subtract(e),i=s.length_sqrd();if(i<.01)return x;const n=Math.sqrt(i),o=v*(n-20);return{x:-Math.round(s.x/n*o),y:-Math.round(s.y/n*o)}}class E{constructor(t,e){this.finished=!1,this.scene=t,this.step_time_ms=200,this.scene.start(),this.algorithm_name=e,this.generator=null,this.playing=!0,this.start_btn=document.getElementById("start-btn"),this.start_btn&&(this.start_btn.addEventListener("click",()=>{this.playing?t.stop():t.start(),this.playing=!this.playing,this.start_btn.innerText=this.playing?"Pause":"Play"}),this.start_btn.innerText=this.playing?"Pause":"Play")}load(t){this.scene.clear();const e=new Set;console.log("loading",t);const s=document.getElementById("debug-data");s?s.textContent="":console.error("Debugging panel not found"),function(t,e,s=20){const i=e.ctx.canvas.getBoundingClientRect();let n=i.width/2,o=i.height/2,h=0,a=0,r=1,d=0,l=0,u=0;for(const i of t.getNodes()){let t=h*Math.cos(u)-0*Math.sin(u)+n,m=h*Math.sin(u)+0*Math.cos(u)+o;console.log("ADDED",i,":",e.addNode(i,new c(t,m),20)),d++,u+=l,d===r&&(a++,h=2*s*a,u=0,d=0,l=Math.acos(1-1/(2*a*a)),r=Math.round(2*Math.PI/l))}}(t,this.scene);for(const i of t.getNodes()){if(s){const t=document.createElement("div");t.id=i.toString(),t.classList.add("node"),s.append(t)}for(const s of t.getNeighbors(i))e.has(s)||(console.log(i,"->",s),this.scene.addEdge(i,s),e.add(s));e.add(i)}}stop(){}reset(){}}class T{constructor(t,e=!0){this.start_node=t,this.bidirectional=e,this.adjacency_mapping=new Map,this.addNode(t)}addNode(t){return this.adjacency_mapping.has(t)||this.adjacency_mapping.set(t,new Set),this}attach(t,e){var s;this.addNode(t);let i=this.adjacency_mapping.get(t);for(const n of e)this.addNode(n),null==i||i.add(n),this.bidirectional&&(null===(s=this.adjacency_mapping.get(n))||void 0===s||s.add(t));return this}getNeighbors(t){var e;return Array.from(null!==(e=this.adjacency_mapping.get(t))&&void 0!==e?e:[])}getNodes(){return Array.from(this.adjacency_mapping.keys())}toString(){let t="";for(const[e,s]of this.adjacency_mapping.entries())t+=`${e} → ${[...s].join(", ")}`;return t}}const A=new T("A").attach("A",["B","C","D"]).attach("B",["E","F"]),L=new T("Cluster1").attach("Cluster1",["C1A","C1B","C1C"]).attach("C1A",["C1B","C1C"]).attach("C1B",["C1C"]).attach("Cluster2",["C2A","C2B","C2C"]).attach("C2A",["C2B","C2C"]).attach("C2B",["C2C"]).attach("Cluster3",["C3A","C3B","C3C"]).attach("C3A",["C3B","C3C"]).attach("C3B",["C3C"]).attach("Cluster1",["Cluster2"]).attach("Cluster2",["Cluster3"]),R=new T("Center").attach("Center",["N1","N2","N3","N4","N5","N6"]).attach("N1",["N2","N6"]).attach("N2",["N1","N3"]).attach("N3",["N2","N4"]).attach("N4",["N3","N5"]).attach("N5",["N4","N6"]).attach("N6",["N5","N1"]),I=new T("C1N1").attach("C1N1",["C1N2","C1N3","C1N4"]).attach("C1N2",["C1N5","C1N6"]).attach("C1N3",["C1N7","C1N8"]).attach("C1N4",["C1N9","C1N10"]).attach("C2N1",["C2N2","C2N3","C2N4"]).attach("C2N2",["C2N5","C2N6"]).attach("C2N3",["C2N7","C2N8"]).attach("C2N4",["C2N9","C2N10"]).attach("C3N1",["C3N2","C3N3","C3N4"]).attach("C3N2",["C3N5","C3N6"]).attach("C3N3",["C3N7","C3N8"]).attach("C3N4",["C3N9","C3N10"]).attach("C4N1",["C4N2","C4N3","C4N4"]).attach("C4N2",["C4N5","C4N6"]).attach("C4N3",["C4N7","C4N8"]).attach("C4N4",["C4N9","C4N10"]).attach("C5N1",["C5N2","C5N3","C5N4"]).attach("C5N2",["C5N5","C5N6"]).attach("C5N3",["C5N7","C5N8"]).attach("C5N4",["C5N9","C5N10"]).attach("C6N1",["C6N2","C6N3","C6N4"]).attach("C6N2",["C6N5","C6N6"]).attach("C6N3",["C6N7","C6N8"]).attach("C6N4",["C6N9","C6N10"]).attach("C7N1",["C7N2","C7N3","C7N4"]).attach("C7N2",["C7N5","C7N6"]).attach("C7N3",["C7N7","C7N8"]).attach("C7N4",["C7N9","C7N10"]).attach("C8N1",["C8N2","C8N3","C8N4"]).attach("C8N2",["C8N5","C8N6"]).attach("C8N3",["C8N7","C8N8"]).attach("C8N4",["C8N9","C8N10"]).attach("C9N1",["C9N2","C9N3","C9N4"]).attach("C9N2",["C9N5","C9N6"]).attach("C9N3",["C9N7","C9N8"]).attach("C9N4",["C9N9","C9N10"]).attach("C10N1",["C10N2","C10N3","C10N4"]).attach("C10N2",["C10N5","C10N6"]).attach("C10N3",["C10N7","C10N8"]).attach("C10N4",["C10N9","C10N10"]).attach("C1N1",["C2N1"]).attach("C2N1",["C3N1"]).attach("C3N1",["C4N1"]).attach("C4N1",["C5N1"]).attach("C5N1",["C6N1"]).attach("C6N1",["C7N1"]).attach("C7N1",["C8N1"]).attach("C8N1",["C9N1"]).attach("C9N1",["C10N1"]);document.addEventListener("DOMContentLoaded",()=>{let t=!1;const e=document.getElementById("canvas-container"),s=document.getElementById("main-canvas"),i=s.getContext("2d",{alpha:!1});if(!s)return void console.log("Main canvas is undefined");if(!i)return void console.log("Context is undefined");const n=document.getElementById("toggle-button"),o=document.getElementById("data-container"),a=document.getElementById("slider"),c=new N(i,!0);function d(){n&&e&&o&&(n.hidden=window.innerWidth>740,n.hidden?(e.classList.remove("hidden"),o.classList.remove("hidden"),t=!0):(o.style.width="",e.style.width="",console.log(t),t||e.classList.contains("hidden")?t&&!o.classList.contains("hidden")&&(e.classList.remove("hidden"),o.classList.add("hidden")):(e.classList.add("hidden"),o.classList.remove("hidden"))),t=!e.classList.contains("hidden"),t?c.start():c.stop())}function l(t){if(!e)return;const s=window.devicePixelRatio||1,i=e.getBoundingClientRect();t.canvas.width=Math.round(i.width*s),t.canvas.height=Math.round(i.height*s),t.canvas.style.width=`${i.width}px`,t.canvas.style.height=`${i.height}px`,t.resetTransform(),t.scale(s,s),console.debug("Canvas resized:",{css:`${i.width}x${i.height}`,actual:`${t.canvas.width}x${t.canvas.height}`,ratio:s})}window.addEventListener("resize",()=>{d(),l(i)});let u=!1;a&&a.addEventListener("mousedown",()=>{u=!0}),window.addEventListener("mouseup",()=>{u=!1,m&&(l(i),m=!1)});let m=!1;window.addEventListener("mousemove",t=>{if(e&&!(window.innerWidth<740)&&u&&t.clientX<window.innerWidth&&t.clientX>0){const s=t.pageX;e.style.width=`${s}px`,l(i),t.preventDefault(),t.stopImmediatePropagation()}}),n&&e&&o&&n.addEventListener("click",()=>{t?(e.classList.add("hidden"),o.classList.remove("hidden")):(e.classList.remove("hidden"),o.classList.add("hidden")),t=!t,t?c.start():c.stop()}),r.setThemeType(h.AUTO),e&&a&&(e.style.width=`${a.getBoundingClientRect().x}px`),l(i),d();const g=new E(c,"DFS Graph Traversal"),C=document.getElementById("config-dropdown");if(C){const t={simple:A,"clustered small":L,"spider web":R,"large clustered":I};for(const e in t){const t=document.createElement("option");t.innerText=e,C.appendChild(t)}C.value=C.options[3].value,g.load(t[C.value]),C.addEventListener("change",()=>{g.load(t[C.value]),console.log("changing")})}})})();